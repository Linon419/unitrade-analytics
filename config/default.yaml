# Unitrade analytics configuration
# Exchange configuration
exchanges:
  binance:
    enabled: true
    api_mode: "public"           # public / private
    api_key: ""              # env: BINANCE_API_KEY
    api_secret: ""           # env: BINANCE_API_SECRET
    testnet: false
    max_connections: 5
    heartbeat_interval: 30
    reconnect_max_attempts: 10
    symbols: [BTCUSDT, ETHUSDT]

  bybit:
    enabled: false
    api_mode: "public"
    api_key: ""              # env: BYBIT_API_KEY
    api_secret: ""           # env: BYBIT_API_SECRET
    testnet: false
    heartbeat_interval: 20
    reconnect_max_attempts: 10
    symbols: [BTCUSDT, ETHUSDT]

# Database configuration
database:
  sqlite_path: "data/unitrade.db"
  redis_url: "redis://redis:6379"
  data_retention_days: 30

# Telegram configuration
telegram:
  enabled: true
  bot_token: ""
  chat_id: ""
  
  topics:
    general: 1
    ema_ranking: 2
    ema_entering: 3
    ema_flowering: 4
    squeeze_daily_weekly: 5
    squeeze_4h_1h: 6
    divergence_normal: 7
    divergence_volume: 8
    wavetrend_overbought_oversold: 9
    signal_anomaly: 62
  
  scheduled_reports:
    ema_report: false
    market_report: false
    ema_interval: 3600
    market_interval: 1800


# Anomaly detector
anomaly_detector:
  enabled: true
  
  timeframes: ["15m", "30m"]
  
  oi_change_threshold: 0.02
  oi_lookback_bars: 1  # compare previous bar
  ema_period: 200
  require_ema200_breakout: false # allow above-EMA continuation
  rvol_threshold: 3.0
  rvol_lookback: 20
  net_inflow_ratio_threshold: 0.05  # Net inflow ratio vs quote volume
  cooldown_seconds: 1800
  
  scan_all: true
  universe_max_symbols: 0  # 0 disables cap
  top_n: 50
  exclude_symbols: []
  candidate_max_ema200_distance_pct: 0  # 0 disables EMA proximity filter
  candidate_below_ema200_only: false
  kline_limit: 500
  
  rising_index:
    enabled: true
    price_structure_weight: 0.35
    oi_flow_weight: 0.30
    recency_weight: 0.20
    volume_weight: 0.15
    recency_decay_hours: 24.0
    signal_ttl_days: 5
  
  telegram_push:
    enabled: true
    interval_hours: 4
    top_n: 10

# Squeeze scanner
squeeze_scanner:
  enabled: true
  
  timeframes: ["1h", "4h", "1d"]
  
  squeeze_len: 20
  bb_mult: 2.0
  kc_mult: 1.5
  atr_len: 20
  
  min_squeeze_duration: 5
  tightness_l2_ratio: 0.80
  momentum_len: 12
  
  top_n: 50
  extra_whitelist: [BTCUSDT, ETHUSDT]
  kline_limit: 200
  max_concurrent: 20

# EMA radar
ema_radar:
  enabled: false
  
  timeframes: ["1h", "4h"]
  ema_periods: [21, 55, 100, 200]
  near_ema_threshold: 0.01
  top_n_results: 10

# WaveTrend scanner
wavetrend_scanner:
  enabled: false
  
  timeframes: ["5m", "15m", "30m", "1h", "4h", "1d"]
  algo_type: "WaveTrend + MFI Hybrid"
  use_ha: false
  
  channel_len: 9
  avg_len: 7
  smooth_len: 4
  ma_type: "ALMA"
  laguerre_gamma: 0.66
  
  wt_weight: 0.4
  mfi_len: 7
  hybrid_mfi_len: 7
  
  lvl_1: 45
  lvl_2_base: 60
  lvl_2_floor: 50
  lvl_3_base: 68
  lvl_3_floor: 48
  mult: 1.2
  step_size: 6.6
  sigmoid_gain: 1.8
  use_sigmoid: true
  osc_min: -60
  osc_max: 60
  
  vol_len: 60
  vol_trigger: 1.6
  vol_weight: 3.0
  
  squeeze_len: 20
  bb_mult: 2.0
  kc_mult: 1.5
  atr_len: 20
  min_squeeze_duration: 5
  tightness_l2_ratio: 0.80
  
  lb_left: 20
  lb_right: 0
  search_limit: 65
  require_candle_conf: true
  use_adx_filter_div: false
  adx_len: 14
  adx_limit: 30
  ha_warmup: 0
  kline_limit: 500
  use_kline_cache: true
  kline_db_path: "data/klines.db"
  
  top_n: 50
  max_concurrent: 20
  extra_whitelist: [BTCUSDT, ETHUSDT, SOLUSDT, DOGEUSDT, XRPUSDT]

# OI spike scanner
oi_spike_scanner:
  enabled: false
  
  auto_top_n: 150
  extra_whitelist: [PEPEUSDT]
  ignore_list: [BTCUSDT, ETHUSDT, BNBUSDT]
  
  oi_period: "5m"
  oi_limit: 30
  ma_short_periods: 3
  ma_long_periods: 30
  spike_threshold: 1.20
  
  max_concurrent_requests: 10
  request_delay: 0.1
  scan_interval_minutes: 5

# Signal detector
signal_detector:
  enabled: false 
  
  rvol_threshold: 1.5
  net_flow_threshold: 80000
  price_change_threshold: 2.0
  rebound_threshold: 5.0
  debounce_minutes: 5
  min_quote_volume_24h: 1000000
  max_symbols: 50
  topic_id: 62

# Realtime service
realtime:
  enabled: true
  symbols:
    - BTCUSDT
    - ETHUSDT
    - BNBUSDT
    - SOLUSDT
    - DOGEUSDT
    - LTCUSDT
    - LDOUSDT
    - CRVUSDT
    - LINKUSDT
    - ADAUSDT
    - UNIUSDT
    - ONDOUSDT
    - AAVEUSDT
    - AVAXUSDT
    - PEPEUSDT
    - SUIUSDT
    - SEIUSDT
    - WLDUSDT
    - HYPEUSDT
    - TRUMPUSDT
    - PUMPUSDT
    - ZECUSDT
  max_buckets: 100
  db_path: "data/market_data.db"

analytics:
  obi_depth_levels: 10
  cvd_history_size: 1000
  volatility_window_seconds: 60
  volatility_sample_interval: 1.0
  oi_poll_interval: 5.0
  oi_history_size: 60
  oi_change_threshold: 0.005
  price_change_threshold: 0.001

log_level: INFO
